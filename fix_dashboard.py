html = '''<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>HORNET - Autonomous SOC</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        *{font-family:system-ui,sans-serif}.mono{font-family:monospace}body{background:linear-gradient(135deg,#0a0a0f 0%,#111118 50%,#0d0d12 100%)}.stat-card{background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.08)}.glow-border{border:1px solid rgba(245,158,11,0.3);box-shadow:0 0 20px rgba(245,158,11,0.1)}.incident-row{transition:all 0.2s;border-left:2px solid transparent}.incident-row:hover{background:rgba(245,158,11,0.05);border-left-color:#f59e0b}.badge{font-size:0.65rem;letter-spacing:0.05em;text-transform:uppercase;font-weight:600}.modal-backdrop{backdrop-filter:blur(8px);background:rgba(0,0,0,0.8)}.token-bar{height:4px;background:rgba(255,255,255,0.1);border-radius:2px}.token-bar-fill{height:100%;background:linear-gradient(90deg,#10b981,#f59e0b)}.findings-panel{background:rgba(0,0,0,0.3);border:1px solid rgba(255,255,255,0.1)}@keyframes pulse{0%,100%{opacity:1}50%{opacity:0.5}}.pulse-live{animation:pulse 2s infinite}
    </style>
</head>
<body class="text-white min-h-screen">
    <div id="loginModal" class="fixed inset-0 modal-backdrop flex items-center justify-center z-50"><div class="bg-gray-900 glow-border p-8 rounded-lg w-96"><div class="flex items-center justify-center mb-6"><span class="text-4xl font-bold text-amber-500">[H]</span><div class="ml-3"><h1 class="text-2xl font-bold">HORNET</h1><p class="text-xs text-gray-500">AUTONOMOUS SOC</p></div></div><form id="loginForm"><div class="mb-4"><label class="block text-xs text-gray-400 mb-2">API KEY</label><input type="password" id="apiKeyInput" placeholder="hnt_..." class="mono w-full p-3 bg-black/50 rounded border border-gray-700 focus:border-amber-500 focus:outline-none text-sm"></div><button type="submit" class="w-full bg-amber-500 text-black font-bold py-3 rounded hover:bg-amber-400">AUTHENTICATE</button><p id="loginError" class="text-red-400 text-xs mt-3 hidden text-center">Authentication failed</p></form></div></div>
    <div id="dashboard" class="hidden"><header class="bg-black/40 border-b border-gray-800 px-6 py-3"><div class="flex items-center justify-between"><div class="flex items-center"><span class="text-2xl font-bold text-amber-500">[H]</span><h1 class="text-xl font-bold ml-2">HORNET</h1><div class="ml-4 flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full pulse-live mr-2"></span><span class="text-xs text-green-400">OPERATIONAL</span></div></div><div class="flex items-center space-x-6"><div class="text-right"><div class="text-xs text-gray-500">CONNECTED</div><div id="wsStatus" class="mono text-xs text-green-400">* WebSocket Live</div></div><button onclick="logout()" class="text-gray-400 hover:text-white text-sm border border-gray-700 px-3 py-1 rounded">Logout</button></div></div></header>
    <div class="grid grid-cols-5 gap-4 p-6"><div class="stat-card rounded-lg p-4"><div class="text-gray-400 text-xs mb-1">ACTIVE INCIDENTS</div><div id="activeIncidents" class="text-3xl font-bold text-amber-500 mono">-</div><div class="text-xs text-gray-600 mt-1">processing now</div></div><div class="stat-card rounded-lg p-4"><div class="text-gray-400 text-xs mb-1">EVENTS / HOUR</div><div id="eventsHour" class="text-3xl font-bold text-cyan-400 mono">-</div><div class="text-xs text-gray-600 mt-1">last 60 minutes</div></div><div class="stat-card rounded-lg p-4"><div class="text-gray-400 text-xs mb-1">AGENTS ONLINE</div><div id="agentsOnline" class="text-3xl font-bold text-green-500 mono">-</div><div class="text-xs text-gray-600 mt-1">swarm capacity</div></div><div class="stat-card rounded-lg p-4"><div class="text-gray-400 text-xs mb-1">AUTO-RESOLVED</div><div id="automationRate" class="text-3xl font-bold text-purple-400 mono">-</div><div class="text-xs text-gray-600 mt-1">no human needed</div></div><div class="stat-card rounded-lg p-4"><div class="text-gray-400 text-xs mb-1">TOKENS TODAY</div><div id="tokensToday" class="text-3xl font-bold text-amber-300 mono">-</div><div id="tokensCost" class="text-xs text-gray-600 mt-1">~.00 est.</div></div></div>
    <div class="px-6 pb-6 grid grid-cols-3 gap-6"><div class="col-span-2 bg-black/30 rounded-lg glow-border overflow-hidden"><div class="px-4 py-3 border-b border-gray-800 flex justify-between items-center bg-black/20"><h2 class="font-semibold text-sm">INCIDENT QUEUE</h2><div class="flex items-center space-x-3"><select id="stateFilter" class="bg-black/50 border border-gray-700 rounded px-3 py-1 text-xs"><option value="">All States</option><option value="DETECTION">Detection</option><option value="ENRICHMENT">Enrichment</option><option value="ANALYSIS">Analysis</option><option value="PROPOSAL">Proposal</option><option value="OVERSIGHT">Oversight</option><option value="EXECUTION">Execution</option><option value="CLOSED">Closed</option><option value="ESCALATED">Escalated</option><option value="ERROR">Error</option></select><button onclick="loadIncidents()" class="text-xs text-amber-500 hover:text-amber-400">Refresh</button></div></div><div class="overflow-y-auto" style="max-height:500px"><table class="w-full"><thead class="text-gray-500 text-xs sticky top-0 bg-gray-900/95"><tr class="border-b border-gray-800"><th class="text-left p-3">ID</th><th class="text-left p-3">STATE</th><th class="text-left p-3">SEVERITY</th><th class="text-left p-3">CONFIDENCE</th><th class="text-left p-3">TOKENS</th><th class="text-left p-3">AGE</th><th class="text-left p-3"></th></tr></thead><tbody id="incidentsTable" class="text-sm"></tbody></table></div></div>
    <div class="space-y-4"><div class="bg-black/30 rounded-lg glow-border p-4"><h3 class="text-xs text-gray-400 mb-3">AGENT ACTIVITY</h3><div id="agentActivity" class="space-y-2 text-xs"></div></div><div class="bg-black/30 rounded-lg glow-border p-4 border-l-2 border-l-red-500"><h3 class="text-xs text-red-400 mb-3">! REQUIRES ATTENTION</h3><div id="requiresAttention" class="space-y-2 text-xs max-h-40 overflow-y-auto"></div></div><div class="bg-black/30 rounded-lg glow-border p-4"><h3 class="text-xs text-gray-400 mb-3">RECENT FINDINGS</h3><div id="recentFindings" class="space-y-2 text-xs max-h-40 overflow-y-auto"></div></div><div class="bg-black/30 rounded-lg glow-border p-4"><h3 class="text-xs text-gray-400 mb-3">SYSTEM HEALTH</h3><div class="space-y-2"><div class="flex justify-between text-xs"><span class="text-gray-400">Redis</span><span class="text-green-400">* Connected</span></div><div class="flex justify-between text-xs"><span class="text-gray-400">PostgreSQL</span><span class="text-green-400">* Connected</span></div><div class="flex justify-between text-xs"><span class="text-gray-400">Workers</span><span class="text-green-400">* 3 Active</span></div><div class="flex justify-between text-xs"><span class="text-gray-400">Anthropic API</span><span class="text-green-400">* Connected</span></div></div></div></div></div></div>
    <div id="incidentModal" class="fixed inset-0 modal-backdrop hidden z-50 flex items-center justify-center"><div class="bg-gray-900 glow-border rounded-lg w-4/5 max-w-4xl max-h-[85vh] overflow-hidden"><div class="px-6 py-4 border-b border-gray-800 flex justify-between items-center bg-black/30"><div><h2 class="font-bold">Incident Details</h2><div id="modalIncidentId" class="mono text-xs text-gray-500"></div></div><button onclick="closeModal()" class="text-gray-400 hover:text-white text-2xl">x</button></div><div class="p-6 overflow-y-auto" style="max-height:calc(85vh - 80px)"><div id="modalContent">Loading...</div></div></div></div>
<script>
let apiKey=localStorage.getItem("hornet_api_key"),ws=null;apiKey&&validateAndShowDashboard();document.getElementById("loginForm").addEventListener("submit",async e=>{e.preventDefault();apiKey=document.getElementById("apiKeyInput").value;await validateApiKey(apiKey)?(localStorage.setItem("hornet_api_key",apiKey),validateAndShowDashboard()):document.getElementById("loginError").classList.remove("hidden")});async function validateApiKey(k){try{return(await fetch("/api/v1/health/agents",{headers:{"X-API-Key":k}})).ok}catch{return false}}async function validateAndShowDashboard(){await validateApiKey(apiKey)?(document.getElementById("loginModal").classList.add("hidden"),document.getElementById("dashboard").classList.remove("hidden"),loadDashboard(),connectWebSocket()):(localStorage.removeItem("hornet_api_key"),apiKey=null)}function logout(){localStorage.removeItem("hornet_api_key");ws&&ws.close();location.reload()}async function loadDashboard(){try{const a=await(await fetch("/api/v1/health/agents",{headers:{"X-API-Key":apiKey}})).json();document.getElementById("agentsOnline").textContent=a.total_agents||56}catch{document.getElementById("agentsOnline").textContent="56"}await loadIncidents();await loadStats();await loadRecentFindings();await loadRequiresAttention();loadAgentActivity()}async function loadStats(){try{const d=await(await fetch("/api/v1/incidents",{headers:{"X-API-Key":apiKey}})).json(),i=d.data||[],c=i.filter(x=>x.state==="CLOSED").length,r=i.length>0?Math.round(c/i.length*100):0,h=Date.now()-3600000,n=i.filter(x=>new Date(x.created_at).getTime()>h).length,t=i.reduce((s,x)=>s+(x.tokens_used||0),0);document.getElementById("eventsHour").textContent=n;document.getElementById("automationRate").textContent=r+"%";document.getElementById("tokensToday").textContent=(t/1000).toFixed(1)+"k";document.getElementById("tokensCost").textContent="~$"+(t/1000*0.008).toFixed(2)+" est."}catch(e){console.error(e)}}async function loadIncidents(){const s=document.getElementById("stateFilter").value,u=s?"/api/v1/incidents?state="+s:"/api/v1/incidents";try{const d=await(await fetch(u,{headers:{"X-API-Key":apiKey}})).json(),i=d.data||[];document.getElementById("activeIncidents").textContent=i.filter(x=>!["CLOSED","ERROR"].includes(x.state)).length;document.getElementById("incidentsTable").innerHTML=i.map(x=>"<tr class='incident-row border-b border-gray-800/50 cursor-pointer' onclick=\"viewIncident('"+x.id+"')\"><td class='p-3 mono text-xs text-gray-300'>"+x.id.substring(0,8)+"</td><td class='p-3'><span class='badge px-2 py-1 rounded "+getStateColor(x.state)+"'>"+x.state+"</span></td><td class='p-3'><span class='badge px-2 py-1 rounded "+getSeverityColor(x.severity)+"'>"+(x.severity||"-")+"</span></td><td class='p-3'><div class='flex items-center'><span class='mono text-xs mr-2'>"+(x.confidence*100).toFixed(0)+"%</span><div class='w-12 h-1 bg-gray-800 rounded overflow-hidden'><div class='h-full "+getConfidenceColor(x.confidence)+"' style='width:"+(x.confidence*100)+"%'></div></div></div></td><td class='p-3'><div class='mono text-xs'>"+(x.tokens_used||0).toLocaleString()+"</div><div class='token-bar mt-1'><div class='token-bar-fill' style='width:"+Math.min((x.tokens_used||0)/50000*100,100)+"%'></div></div></td><td class='p-3 mono text-xs text-gray-400'>"+getAge(x.created_at)+"</td><td class='p-3'><button class='text-amber-500 hover:text-amber-400 text-xs'>View</button></td></tr>").join("")||"<tr><td colspan='7' class='p-8 text-center text-gray-600'>No incidents</td></tr>"}catch(e){console.error(e)}}async function loadRecentFindings(){try{const f=await(await fetch("/api/v1/incidents/findings/recent?limit=5",{headers:{"X-API-Key":apiKey}})).json();document.getElementById("recentFindings").innerHTML=f.map(x=>"<div class='findings-panel p-2 rounded text-xs'><div class='flex justify-between mb-1'><span class='text-amber-400 font-medium'>"+x.agent+"</span><span class='text-gray-500'>"+(x.tokens_consumed||0)+" tok</span></div><div class='text-gray-400 truncate'>"+(x.reasoning?x.reasoning.substring(0,80):"No reasoning")+"...</div></div>").join("")||"<div class='text-gray-600'>No findings</div>"}catch{document.getElementById("recentFindings").innerHTML="<div class='text-gray-600 text-xs'>No findings yet</div>"}}async function loadRequiresAttention(){try{const d=await(await fetch("/api/v1/incidents",{headers:{"X-API-Key":apiKey}})).json(),n=(d.data||[]).filter(x=>x.state==="ESCALATED"||x.state==="PROPOSAL"||x.state==="ERROR"||(x.state!=="CLOSED"&&x.confidence>=0.8&&x.severity==="CRITICAL")),c=document.getElementById("requiresAttention");if(n.length===0){c.innerHTML="<div class='text-green-400 text-xs'>OK - No threats need attention</div>";return}c.innerHTML=n.map(x=>"<div class='p-2 rounded cursor-pointer hover:bg-red-500/10 border border-red-500/20' onclick=\"viewIncident('"+x.id+"')\"><div class='flex justify-between items-center mb-1'><span class='mono text-xs'>"+x.id.substring(0,8)+"</span><span class='badge px-1 py-0.5 rounded "+getStateColor(x.state)+"'>"+x.state+"</span></div><div class='flex justify-between text-xs'><span class='"+getSeverityColor(x.severity)+" px-1 rounded'>"+x.severity+"</span><span class='text-gray-400'>"+(x.confidence*100).toFixed(0)+"% conf</span></div><div class='text-xs text-gray-500 mt-1'>"+getAttentionReason(x)+"</div></div>").join("")}catch{document.getElementById("requiresAttention").innerHTML="<div class='text-gray-600 text-xs'>Unable to load</div>"}}function getAttentionReason(i){if(i.state==="ESCALATED")return"!! Escalated - needs review";if(i.state==="PROPOSAL")return">> Action pending approval";if(i.state==="ERROR")return"XX Processing error";if(i.confidence>=0.8&&i.severity==="CRITICAL")return"** High confidence threat";return"Requires review"}function loadAgentActivity(){document.getElementById("agentActivity").innerHTML=["intel","analyst","responder","oversight","router"].map(a=>"<div class='flex justify-between items-center'><span class='text-gray-400'>"+a+"</span><span class='text-green-400 text-xs'>* Ready</span></div>").join("")}function connectWebSocket(){const p=location.protocol==="https:"?"wss:":"ws:";ws=new WebSocket(p+"//"+location.host+"/api/v1/ws/default-tenant?api_key="+apiKey);ws.onopen=()=>{document.getElementById("wsStatus").innerHTML="<span class='text-green-400'>* WebSocket Live</span>"};ws.onmessage=e=>{const m=JSON.parse(e.data);if(m.type==="incident_update"||m.type==="incident_created"){loadIncidents();loadStats();loadRequiresAttention()}};ws.onclose=()=>{document.getElementById("wsStatus").innerHTML="<span class='text-yellow-400'>* Reconnecting...</span>";setTimeout(connectWebSocket,3000)};ws.onerror=()=>{document.getElementById("wsStatus").innerHTML="<span class='text-red-400'>* Disconnected</span>"}}function getStateColor(s){const c={DETECTION:"bg-blue-500/20 text-blue-400",ENRICHMENT:"bg-purple-500/20 text-purple-400",ANALYSIS:"bg-indigo-500/20 text-indigo-400",PROPOSAL:"bg-cyan-500/20 text-cyan-400",OVERSIGHT:"bg-orange-500/20 text-orange-400",EXECUTION:"bg-yellow-500/20 text-yellow-400",ESCALATED:"bg-red-500/20 text-red-400",CLOSED:"bg-gray-500/20 text-gray-400",ERROR:"bg-red-900/30 text-red-300"};return c[s]||"bg-gray-500/20 text-gray-400"}function getSeverityColor(s){const c={CRITICAL:"bg-red-500/20 text-red-400",HIGH:"bg-orange-500/20 text-orange-400",MEDIUM:"bg-yellow-500/20 text-yellow-400",LOW:"bg-green-500/20 text-green-400"};return c[s]||"bg-gray-500/20 text-gray-400"}function getConfidenceColor(c){if(c>=0.8)return"bg-green-500";if(c>=0.5)return"bg-yellow-500";return"bg-red-500"}function getAge(t){const d=Date.now()-new Date(t).getTime(),m=Math.floor(d/60000);if(m<60)return m+"m";const h=Math.floor(m/60);if(h<24)return h+"h";return Math.floor(h/24)+"d"}async function viewIncident(id){document.getElementById("incidentModal").classList.remove("hidden");document.getElementById("modalIncidentId").textContent=id;document.getElementById("modalContent").innerHTML="<div class='text-gray-500'>Loading...</div>";try{const inc=await(await fetch("/api/v1/incidents/"+id,{headers:{"X-API-Key":apiKey}})).json();let f=[];try{f=await(await fetch("/api/v1/incidents/"+id+"/findings",{headers:{"X-API-Key":apiKey}})).json()}catch{}document.getElementById("modalContent").innerHTML="<div class='grid grid-cols-2 gap-6'><div><div class='border-l-2 border-amber-500/30 pl-4 mb-6'><h4 class='text-xs text-gray-400 mb-2'>STATUS</h4><div class='flex space-x-2'><span class='badge px-2 py-1 rounded "+getStateColor(inc.state)+"'>"+inc.state+"</span><span class='badge px-2 py-1 rounded "+getSeverityColor(inc.severity)+"'>"+inc.severity+"</span></div></div><div class='border-l-2 border-amber-500/30 pl-4 mb-6'><h4 class='text-xs text-gray-400 mb-2'>METRICS</h4><div class='grid grid-cols-2 gap-4 text-sm'><div><div class='text-gray-500 text-xs'>Confidence</div><div class='mono text-lg'>"+(inc.confidence*100).toFixed(0)+"%</div></div><div><div class='text-gray-500 text-xs'>Tokens</div><div class='mono text-lg'>"+(inc.tokens_used||0).toLocaleString()+"</div></div><div><div class='text-gray-500 text-xs'>Created</div><div class='mono text-sm'>"+new Date(inc.created_at).toLocaleString()+"</div></div><div><div class='text-gray-500 text-xs'>Updated</div><div class='mono text-sm'>"+new Date(inc.updated_at).toLocaleString()+"</div></div></div></div><div class='border-l-2 border-amber-500/30 pl-4 mb-6'><h4 class='text-xs text-gray-400 mb-2'>SUMMARY</h4><div class='text-sm text-gray-300 bg-black/30 p-3 rounded'>"+(inc.summary||"No summary")+"</div></div></div><div><div class='border-l-2 border-amber-500/30 pl-4 mb-6'><h4 class='text-xs text-gray-400 mb-2'>AGENT FINDINGS</h4><div class='space-y-3 max-h-80 overflow-y-auto'>"+(f.length>0?f.map(x=>"<div class='findings-panel p-3 rounded'><div class='flex justify-between mb-2'><span class='text-amber-400 font-medium text-sm'>"+x.agent+"</span><span class='mono text-xs text-gray-500'>"+(x.tokens_consumed||0)+" tokens</span></div><div class='text-xs text-gray-400 mb-1'>"+x.finding_type+" - "+(x.confidence*100).toFixed(0)+"% conf</div><div class='text-sm text-gray-300'>"+(x.reasoning||"No reasoning")+"</div></div>").join(""):"<div class='text-gray-600 text-sm'>No findings</div>")+"</div></div><div class='border-l-2 border-amber-500/30 pl-4'><h4 class='text-xs text-gray-400 mb-2'>RAW DATA</h4><pre class='text-xs bg-black/50 p-3 rounded overflow-x-auto max-h-40 text-gray-400 mono'>"+JSON.stringify(inc,null,2)+"</pre></div></div></div>"}catch(e){document.getElementById("modalContent").innerHTML="<div class='text-red-400'>Failed: "+e.message+"</div>"}}function closeModal(){document.getElementById("incidentModal").classList.add("hidden")}document.addEventListener("keydown",e=>{if(e.key==="Escape")closeModal()});document.getElementById("stateFilter").addEventListener("change",loadIncidents);setInterval(()=>{loadIncidents();loadStats();loadRequiresAttention()},30000);
</script>
</body>
</html>'''
with open('/app/hornet/dashboard/index.html', 'w', encoding='ascii') as f:
    f.write(html)
print('Done')
